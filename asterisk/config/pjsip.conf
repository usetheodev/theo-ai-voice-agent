;===============================================
; PJSIP Configuration - PABX Interno
;===============================================

[global]
type=global
user_agent=Asterisk PABX

[transport-udp]
type=transport
protocol=udp
bind=0.0.0.0:5160

[transport-wss]
type=transport
protocol=wss
bind=0.0.0.0:8189
; NAT traversal para Docker bridge networking
; __EXTERNAL_IP__ é substituído pelo docker-entrypoint.sh com o IP do host
external_media_address=__EXTERNAL_IP__
external_signaling_address=__EXTERNAL_IP__
; Redes locais (não usar NAT para estas)
; NOTA: 172.16.0.0/12 removido intencionalmente para que conexões
; via Docker gateway sejam tratadas como externas e usem external_media_address
local_net=192.168.0.0/16
local_net=10.0.0.0/8
local_net=127.0.0.0/8

;===============================================
; RAMAL 1001
;===============================================
[1001]
type=aor
max_contacts=5
remove_existing=yes
qualify_frequency=30

[auth1001]
type=auth
auth_type=userpass
username=1001
password=FRGQib50A3gZQSl1NSen

[1001]
type=endpoint
context=interno
disallow=all
allow=ulaw
allow=alaw
auth=auth1001
aors=1001
callerid=Ramal 1001 <1001>
direct_media=no
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
dtmf_mode=rfc4733
timers=yes
timers_sess_expires=1800

;===============================================
; RAMAL 1002
;===============================================
[1002]
type=aor
max_contacts=5
remove_existing=yes
qualify_frequency=30

[auth1002]
type=auth
auth_type=userpass
username=1002
password=jaFViIPZkzejvgHczIFE

[1002]
type=endpoint
context=interno
disallow=all
allow=ulaw
allow=alaw
auth=auth1002
aors=1002
callerid=Ramal 1002 <1002>
direct_media=no
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
dtmf_mode=rfc4733
timers=yes
timers_sess_expires=1800

;===============================================
; RAMAL 1003
;===============================================
[1003]
type=aor
max_contacts=5
remove_existing=yes
qualify_frequency=30

[auth1003]
type=auth
auth_type=userpass
username=1003
password=axkCUAmMk2FyI1NJpLSF

[1003]
type=endpoint
context=interno
disallow=all
allow=ulaw
allow=alaw
auth=auth1003
aors=1003
callerid=Ramal 1003 <1003>
direct_media=no
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
dtmf_mode=rfc4733
timers=yes
timers_sess_expires=1800

;===============================================
; RAMAL 1004 (WebRTC)
;===============================================
[1004]
type=aor
max_contacts=5
remove_existing=yes
qualify_frequency=30

[auth1004]
type=auth
auth_type=userpass
username=1004
password=xe9JDXRiUeK2848Uvoz1

[1004]
type=endpoint
context=interno
disallow=all
allow=opus
allow=ulaw
auth=auth1004
aors=1004
callerid=Ramal WebRTC 1004 <1004>
direct_media=no
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
webrtc=yes
dtls_auto_generate_cert=yes
media_encryption=dtls
dtmf_mode=rfc4733
timers=yes
timers_sess_expires=1800

;===============================================
; RAMAL 1005 (WebRTC)
;===============================================
[1005]
type=aor
max_contacts=5
remove_existing=yes
qualify_frequency=30

[auth1005]
type=auth
auth_type=userpass
username=1005
password=d9nHiKsFcKXmj9tS0NXd

[1005]
type=endpoint
context=interno
disallow=all
allow=opus
allow=ulaw
auth=auth1005
aors=1005
callerid=Ramal WebRTC 1005 <1005>
direct_media=no
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
webrtc=yes
dtls_auto_generate_cert=yes
media_encryption=dtls
dtmf_mode=rfc4733
timers=yes
timers_sess_expires=1800

;===============================================
; RAMAL 2000 (SIP/RTP - Agente Python)
; Ramal dedicado para integração externa
; Usa SIP/RTP tradicional (não WebRTC)
;===============================================
[2000]
type=aor
max_contacts=10
remove_existing=yes
qualify_frequency=30

[auth2000]
type=auth
auth_type=userpass
username=2000
password=7Wslll0Hlc6BCOv4jF51

[2000]
type=endpoint
context=interno
disallow=all
allow=ulaw
allow=alaw
auth=auth2000
aors=2000
callerid=Agente Python <2000>
direct_media=no
rtp_symmetric=yes
force_rport=yes
rewrite_contact=yes
dtmf_mode=rfc4733
timers=yes
timers_sess_expires=1800
